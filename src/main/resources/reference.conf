# sss-events default configuration
# This file provides default values. Override in your application.conf.

sss-events {
  engine {
    # Number of threads in the scheduler thread pool
    scheduler-pool-size = 2

    # Default queue size for EventProcessors when not overridden
    # Range: [1, 1000000], Default: 10000
    # Lower values reduce memory usage but increase risk of queue overflow
    # Higher values provide more buffering but consume more memory
    default-queue-size = 10000

    # Thread-to-dispatcher assignment configuration
    # Array length determines number of threads created
    # Each element is an array of dispatcher names for that thread to work on
    #
    # IMPORTANT: The first thread ["subscriptions"] is dedicated to the Subscriptions EventProcessor.
    # This thread is created at engine startup and is NOT available for configuration with other dispatchers.
    # However, other threads CAN use the "subscriptions" dispatcher via configuration if needed.
    #
    # Example: Single thread working on default dispatcher (backward compatible)
    # thread-dispatcher-assignment = [
    #   ["subscriptions"],    # Dedicated subscriptions thread (required)
    #   [""]
    # ]
    #
    # Example: Multiple threads with different assignments
    # thread-dispatcher-assignment = [
    #   ["subscriptions"],    # Dedicated subscriptions thread (required)
    #   ["api", "realtime"],  # Thread 1 handles api and realtime
    #   ["api"],              # Thread 2 handles api only
    #   ["batch"]             # Thread 3 handles batch only
    # ]
    thread-dispatcher-assignment = [
      ["subscriptions"],  # Dedicated thread for Subscriptions EventProcessor
      [""]                # Default: thread for unnamed dispatcher
    ]

    # Exponential backoff configuration for lock contention
    backoff {
      # Initial delay when all locks fail (microseconds)
      # 10 microseconds = very responsive
      base-delay-micros = 10

      # Multiplier for exponential growth
      # 1.5 = gradual increase (10μs → 15μs → 22μs → 33μs...)
      multiplier = 1.5

      # Maximum delay cap (microseconds)
      # 10000 microseconds = 10 milliseconds
      max-delay-micros = 10000
    }
  }
}
